#name ".//test_files//atoi.cl"












#13 CLASS
A2I {

     c2i(char : String) : Int {
	if char = "0" then 0 #16 ELSE

	if char = "1" then 1 #17 ELSE

	if char = "2" then 2 #18 ELSE

        if char = "3" then 3 #19 ELSE

        if char = "4" then 4 #20 ELSE

        if char = "5" then 5 #21 ELSE

        if char = "6" then 6 #22 ELSE

        if char = "7" then 7 #23 ELSE

        if char = "8" then 8 #24 ELSE

        if char = "9" then 9 #25 ELSE

        { abort(); 0; }  -- the 0 is needed to satisfy the typchecker
        fi fi fi fi fi fi fi fi fi fi
     };




     i2c(i : Int) : String {
	if i = 0 then "0" #34 ELSE

	if i = 1 then "1" #35 ELSE

	if i = 2 then "2" #36 ELSE

	if i = 3 then "3" #37 ELSE

	if i = 4 then "4" #38 ELSE

	if i = 5 then "5" #39 ELSE

	if i = 6 then "6" #40 ELSE

	if i = 7 then "7" #41 ELSE

	if i = 8 then "8" #42 ELSE

	if i = 9 then "9" #43 ELSE

	{ abort(); ""; }  -- the "" is needed to satisfy the typchecker
        fi fi fi fi fi fi fi fi fi fi
     };









     a2i(s : String) : Int {
        if s.length() = 0 then 0 #57 ELSE

	if s.substr(0,1) = "-" then ~a2i_aux(s.substr(1,s.length()-1)) #58 ELSE

        if s.substr(0,1) = "+" then a2i_aux(s.substr(1,s.length()-1)) #59 ELSE

           a2i_aux(s)
        fi fi fi
     };





     a2i_aux(s : String) : Int {
	(let int : Int <- 0 in	
           {	
               (let j : Int <- s.length() in
	          (let i : Int <- 0 in
		    while i < j loop
			{
			    int <- int * 10 + c2i(s.substr(i,1));
			    i <- i + 1;
			}
		    pool
		  )
	       );
              int;
	    }
        )
     };





    i2a(i : Int) : String {
	if i = 0 then "0" #91 ELSE
 
        if 0 < i then i2a_aux(i) #92 ELSE

          "-".concat(i2a_aux(i * ~1)) 
        fi fi
    };
	


		
    i2a_aux(i : Int) : String {
        if i = 0 then "" #101 ELSE
 
	    (let next : Int <- i / 10 in
		i2a_aux(next).concat(i2c(i - next * 10))
	    )
        fi
    };

};
